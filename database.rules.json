{
  "rules": {
    "admins": {
      ".read": "auth != null",
      ".write": "auth != null && root.child('admins').child(auth.uid).exists()"
    },
    "properties": {
      ".read": "auth != null",
      ".write": "auth != null && root.child('admins').child(auth.uid).exists()"
    },
    "users": {
      "$uid": {
        ".read": "auth != null && auth.uid == $uid",
        ".write": "auth != null && auth.uid == $uid"
      }
    },
    "threads": {
      ".read": "auth != null",
      ".write": "auth != null && root.child('admins').child(auth.uid).exists()",
      ".indexOn": ["isGroup", "lastMessageAt"]
    },
    "groups": {
      ".read": "auth != null",
      ".write": "auth != null && root.child('admins').child(auth.uid).exists()",
      ".indexOn": ["createdAt", "lastMessageAt"]
    },
    "messages": {
      "$seller_uid": {
        "$propertyId": {
          ".read": "auth != null && auth.uid == $seller_uid",
          ".write": "auth != null && root.child('admins').child(auth.uid).exists()"
        }
      }
    },
    "complaints": {
      ".read": "auth != null && root.child('admins').child(auth.uid).exists()",
      "$uid": {
        ".read": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
        ".write": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
        ".indexOn": ["timestamp"]
      }
    },
    "feedback": {
      ".read": "auth != null && root.child('admins').child(auth.uid).exists()",
      "$uid": {
        ".read": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
        ".write": "auth != null && (auth.uid == $uid || root.child('admins').child(auth.uid).exists())",
        ".indexOn": ["timestamp"]
      }
    },
    "lost": {
      ".read": "auth != null",
      "$item_id": {
        ".read": "auth != null",
        ".write": "auth != null && (newData.child('uid').val() == auth.uid || root.child('admins').child(auth.uid).exists())",
        ".indexOn": ["timestamp"]
      }
    },
    "found": {
      ".read": "auth != null",
      "$item_id": {
        ".read": "auth != null",
        ".write": "auth != null && (newData.child('uid').val() == auth.uid || root.child('admins').child(auth.uid).exists())",
        ".indexOn": ["timestamp"]
      }
    },
    "alerts": {
      ".read": "auth != null",
      "$alert_id": {
        ".read": "auth != null",
        ".write": "auth != null && root.child('admins').child(auth.uid).exists()",
        ".indexOn": ["timestamp"]
      }
    },
    "incidents": {
      ".read": "auth != null",
      "$incident_id": {
        ".read": "auth != null",
        ".write": "auth != null && ((!data.exists() && newData.child('uid').val() == auth.uid) || root.child('admins').child(auth.uid).exists())",
        ".indexOn": ["timestamp"]
      }
    }
  }
}
